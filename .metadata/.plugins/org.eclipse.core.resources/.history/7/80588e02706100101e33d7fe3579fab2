package com.example.nagoyameshi.service;

import java.util.Optional;

import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.example.nagoyameshi.entity.Company;
import com.example.nagoyameshi.form.CompanyForm;
import com.example.nagoyameshi.repository.CompanyRepository;

@Service
@Transactional
public class CompanyService {

    private final CompanyRepository companyRepository;

    public CompanyService(CompanyRepository companyRepository) {
        this.companyRepository = companyRepository;
    }

    public CompanyForm getCompany() {
        Optional<Company> optional = companyRepository.findById(1L);
        CompanyForm form = new CompanyForm();

        if (optional.isPresent()) {
            Company c = optional.get();
            form.setId(c.getId());
            form.setName(c.getName());
            form.setCeo(c.getCeo());
            form.setEstablished(c.getEstablished());
            form.setPostal(c.getPostal());
            form.setAddress(c.getAddress());
            form.setBusiness(c.getBusiness());
        }
        return form;
    }

    public void updateCompany(CompanyForm form) {
        // id = 1 の会社情報を取得
        Company company = companyRepository.findById(1L)
            .orElseThrow(() -> new RuntimeException("会社情報が見つかりません"));

        // 各項目を更新
        company.setName(form.getName());
        company.setCeo(form.getCeo());
        company.setEstablished(form.getEstablished());
        company.setPostal(form.getPostal());
        company.setAddress(form.getAddress());
        company.setBusiness(form.getBusiness());

        // 保存（update になる）
        companyRepository.save(company);
    }

}
